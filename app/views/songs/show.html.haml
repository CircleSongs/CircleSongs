- if @song.image_url(:thumb)
  = image_tag @song.image_url(:thumb), class: :thumb
%h2
  = @song.title
  - if user_signed_in?
    %small.edit
      = link_to edit_admin_song_path(@song) do
        %i.fa.fa-pencil

  %span.float-end
    %a.back-to-songs{ href: songs_path }
      %i.fa.fa-arrow-left
      Songs
- if @song.alternate_title.present?
  %p= "[#{@song.alternate_title}]"
- if @song.composer.present?
  %p
    By
    - if @song.composer.url.present?
      = link_to @song.composer.name, @song.composer.url, target: :_blank
    - else
      = @song.composer.name
- if @song.description.present?
  = simple_format @song.description

- if feature_enabled? :tagging
  - if @song.theme_list.any?
    - max_taggings_threshold = 5
    %nav.tag-cloud{ role: "navigation", "aria-label": "Song themes", style: "--max-taggings: #{max_taggings_threshold}" }
      %ul
        - tag_counts = Song.theme_counts
        - @song.theme_list.each do |theme|
          - tag = tag_counts.find { |t| t.name == theme }
          - count = tag&.taggings_count || 1
          - weight = [(count.to_f / max_taggings_threshold * 100).round, 100].min
          %li{ style: "--tag-weight: #{weight}" }
            %a{ href: songs_path(q: { themes_name_in: theme }) }= theme

.row
  = render @song.recordings

.row.clearfix
  - if @song.lyrics.present?
    .col.lyrics
      %p
        %strong Lyrics
        = simple_format @song.lyrics, {}, sanitize: false

  - if @song.translation.present?
    .col.translation
      %p
        %strong Translation
        = simple_format @song.translation, {}, sanitize: false

  - if @song.chords.present?
    .col
      %p
        %strong Chords

      %pre
        #song-chords{ data: @song.chords.to_json }

      - @song.chord_forms.order(:position).each do |chord_form|
        %ul.text-center.float-start
          %li.chord-form{ data: { id: chord_form.id, chord: chord_form.chord, fingering: chord_form.fingering }}
          %li= chord_form.chord
