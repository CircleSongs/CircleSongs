.search-strip
  .container
    = form_with url: songs_path, method: :get, html: { class: 'search-strip__inner', role: 'search', 'aria-label': 'Song search' } do |f|
      = f.label 'q[title_or_lyrics_or_composer_name_cont]', 'Search', class: 'sr-only', id: 'song-search-label'
      = f.text_field 'q[title_or_lyrics_or_composer_name_cont]', id: 'song-search', class: 'search-input', type: 'search', placeholder: 'Search for songs here using any word in song title or lyrics, or by composer'
      = f.button 'Search Songs', class: 'search-btn btn btn--wide btn--inline', type: 'submit'

%main
  -# Hero
  %section.hero{"aria-label" => "Featured hero"}
    .hero__bg{"aria-hidden" => "true"}
      = image_tag vite_asset_path('images/hero-bg.jpg'), alt: "Etheral Hallway"
    .container.reset--mobile
      .hero__inner.section
        .grid
          .col-8
            %aside.featured.featured--half{"aria-label" => "Featured song"}
              .featured__label Featured Song
              .featured__inner
                .swiper-pagination
                .swiper{"data-featured-swiper" => ""}
                  .swiper-wrapper
                    - if @featured_songs.any?
                      - @featured_songs.each do |song|
                        .swiper-slide
                          %h3.featured__title.h2.ruled= song.title
                          .featured__meta= song.composer&.name || 'Traditional'
                          .featured__excerpt
                            - if song.lyrics.present?
                              = truncate(song.lyrics, length: 150, separator: "\n")
                          .featured__row
                            = link_to 'View Song', song_path(song), class: 'btn'
                    - else
                      -# PLACEHOLDER: No featured songs
                      .swiper-slide
                        %h3.featured__title.h2.ruled Abre La Puerta
                        .featured__meta Glen Phillips
                        .featured__excerpt
                          Abre la puerta, abre la puerta
                          %br/
                          Abre la puerta, abre la puerta
                          %br/
                          Que entre la vida, que entre el sol
                          %br/
                          Que entre la tierra, en el corazÃ³n...
                        .featured__row
                          = link_to 'View Song', '#', class: 'btn'

  -# Panels
  %section.section.main-texture{"aria-label" => "Explore collections"}
    .container
      .grid.grid--equal-height-cols
        .col-5
          %section.panel.panel--categories{"aria-label" => "Categories"}
            %h2.panel__title.ruled Categories
            %ul.categories-list.list--inline.list--unstyled
              - if @categories.any?
                - @categories.limit(10).each do |category|
                  %li
                    %span= category.name
                    = link_to category.songs.count, songs_path(q: { categories_id_in: category.id }), class: 'btn btn--secondary btn--sm'
              - else
                -# PLACEHOLDER: No categories
                %li
                  %span Water Songs
                  = link_to '14', '#', class: 'btn btn--secondary btn--sm'
        
        .col-6
          %section.panel.panel--themes{"aria-label" => "Song themes"}
            %h2.panel__title.ruled Song Themes
            .themes-cloud{"aria-label" => "Theme cloud"}
              - if respond_to?(:feature_enabled?) && feature_enabled?(:tagging) && @themes.present?
                - max_count = @themes.first.taggings_count.to_f
                - @themes.each do |theme|
                  - weight = (theme.taggings_count / max_count * 100).round
                  - css_class = weight > 60 ? 'is-strong' : ''
                  = link_to theme.name, songs_path(q: { themes_name_in: theme.name }), class: css_class
              - else
                -# PLACEHOLDER: Hardcoded themes
                = link_to 'water', '#'
                = link_to 'healing', '#', class: 'is-strong'
                = link_to 'ceremony', '#'
                = link_to 'fire', '#', class: 'is-strong'
                = link_to 'love', '#', class: 'is-strong'
                = link_to 'earth', '#'
                = link_to 'gratitude', '#'
                = link_to 'prayer', '#'
                = link_to 'peace', '#', class: 'is-strong'
                = link_to 'resilience', '#'
        
        .col-5
          %section.panel.panel--playlists{"aria-label" => "Playlists"}
            %h2.panel__title.ruled Playlists
            %ul.playlist-list.list--inline.list--unstyled
              -# PLACEHOLDER: Hardcoded playlists until you implement playlists
              %li
                %span.playlist-item__left
                  %span.soundcloud-icon{"aria-hidden" => "true"}
                    = image_tag vite_asset_path('images/soundcloud-tile.svg'), width: 24
                  %span Water Songs
                = link_to 'Play >', '#', class: 'btn btn--sm', "aria-label" => "Play Water Songs"
              %li
                %span.playlist-item__left
                  %span.soundcloud-icon{"aria-hidden" => "true"}
                    = image_tag vite_asset_path('images/soundcloud-tile.svg'), width: 24
                  %span Fire Songs
                = link_to 'Play >', '#', class: 'btn btn--sm', "aria-label" => "Play Fire Songs"

  -# About
  %section.section{"aria-label" => "About MedicineSongs.net"}
    .container
      .grid
        .col-12.col-center
          %h1 About MedicineSongs.net
          %p
            Welcome to Medicine Songs, a sacred collection of music from healing traditions around the
            world. Our intention is to preserve and share these powerful songs that have been used for
            ceremony and spiritual connection. We honor the many cultural traditions, tribes, teachers,
            as well as living composers who have shared these songs with reverence and gratitude, in
            service to a more loving, liberated world.
          %p
            This database serves as a resource for practitioners, ceremony leaders, and anyone called to
            work with sacred music. You can search by song title, composer, theme, or browse our curated
            collections and playlists.
          %p
            We believe in the power of music to heal, unite, and transform. May these songs support your
            journey and benefit all beings.
          
          %h2 Who We Are
          %p
            This site is
            = link_to 'by a consortium', '#'
            of musicians devoted to sharing songs in
            ceremonial spaces. We do not profit financially from this project and offer it in the spirit
            of devotion and community-building. If you'd like to see this resource keep flowering, we
            are very grateful for your donations and songbook purchase. These sources of support
            directly enable us to improve and expand this site. Thank you!

  %section.secret-door{"aria-label" => "Illustration band"}
    = image_tag vite_asset_path('images/secret-door.jpg'), alt: "", loading: 'lazy'
    = link_to '', '#', class: 'secret-door-link'